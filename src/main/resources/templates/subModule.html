
<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<script type="text/javascript" th:src="@{/js/settings.js}"></script>
<script type="text/javascript" th:src="@{/js/app.js}"></script>
<link rel="stylesheet" type="text/css" th:href="@{/css/modern.css}" />
<script  src="https://www.googletagmanager.com/gtag/js?id=UA-120946860-7"></script>

	<style>
		body {
			opacity: 0;
		}
	</style>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.js"></script>
	<script src="js/settings.js"></script>
	
	<!-- END SETTINGS -->
<!-- Global site tag (gtag.js) - Google Analytics -->
<script src="https://www.googletagmanager.com/gtag/js?id=UA-120946860-7"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-120946860-7');
</script></head>

<body>

	<div class="wrapper">
<nav id="sidebar" class="sidebar">
 <div th:replace="/fragments/sidebar :: div"></div>
 </nav>
		
		
		<div class="main">
			<nav class="navbar navbar-expand navbar-theme">
				<a class="sidebar-toggle d-flex mr-2">
					<i class="hamburger align-self-center"></i>
				</a>

				<form class="form-inline d-none d-sm-inline-block">
					<h3 align="center" style="color:#ffffff;margin-left: 50px;margin-top: 10px">Government of Haryana  </h3>
						 <h3 align="center" style="color:#ffffff;margin-left: 75px">Ministry of home & Administration of justice </h3>
				</form>

				<div class="navbar-collapse collapse">
					<ul class="navbar-nav ml-auto">

						<li class="nav-item dropdown ml-lg-2">
							<a class="nav-link dropdown-toggle position-relative" href="#" id="userDropdown" data-toggle="dropdown">
								<i class="align-middle fas fa-cog"></i>
							</a>
							<div class="dropdown-menu dropdown-menu-right" aria-labelledby="userDropdown">
								<a class="dropdown-item" href="#"><i class="align-middle mr-1 fas fa-fw fa-user"></i> View Profile</a>
							
								<div class="dropdown-divider"></div>
								<a class="dropdown-item" href="/"><i class="align-middle mr-1 fas fa-fw fa-arrow-alt-circle-right"></i> Sign out</a>
							</div>
						</li>
					</ul>
				</div>

			</nav>
			
			
			
			
			<main class="content">
				<div class="container-fluid">

					<div class="header">
						<h1 class="header-title">
							 Sub Module Master
						</h1>
						<nav aria-label="breadcrumb">
							<ol class="breadcrumb">
								<li class="breadcrumb-item"><a href="dashboard-default.html">Dashboard</a></li>
								<li class="breadcrumb-item"><a href="#">User Role Managment</a></li>
								<li class="breadcrumb-item"><a href="#">Program Master</a></li>
								<li class="breadcrumb-item active" aria-current="page"> Sub Module Master</li>
							</ol>
						</nav>
						</div>
						
						<div class="row">
						<div class="col-12">
							<div class="card">
								
								<div class="card-header">
									<h5 class="card-title"> Sub Module</h5>
									
								</div>
								
								<div class="card-body">
								<form id="validation-form" action="#" th:action="@{/saveSubModule}" th:object="${submodule}" method="post">
									<div class="row">
										<div class="col-12 col-lg-6">
											<div class="form-group">
											 <label style="color:red" >*</label>
												<label>Sub Module Code </label>
												<input type="text" class="form-control" id="subModuleCode" name="subModuleCode">
												
											</div>
											
											
												 <div class="form-group">
											<label class="form-label">Module</label>
											<select class="form-control" name="moduleCode"id="moduleCode">
												<option value="">Select Module</option>
													<option value="1001">Master</option>
													<option value="1002">Auth</option>
												
											</select>
										</div>
										
											<div class="form-group">
											 <label style="color:red">*</label>
											<label class="form-label">Satus</label>
											<div class="custom-controls-stacked">

												<label class="radio-inline">
      											<input type="radio" value="Y" name="acitveSubModule" checked > Active
  													  </label>
   												 <label class="radio-inline">
   											   <input type="radio" name="acitveSubModule"value="N">Inactive
   												 </label>
												
											</div>
										</div>

										</div>
										<div class="col-12 col-lg-6">
											<div class="form-group">
											 <label style="color:red" >*</label>
												<label> Sub Module Name</label>
												<input type="text" class="form-control" id="subModuleName" name="subModuleName">
												
											</div>
											<div class="form-group">
												<label>Sequence No</label>
												<input type="text" class="form-control" id="seqNoSubModule"data-mask="00" name="seqNoSubModule">
												
											</div>
											
										</div>
										
									</div>
									<button type="submit" class="btn btn-primary">Save</button>
									 <button type="reset"class="btn btn-primary" value="Reset">Reset</button>
									
									</form>
								</div>
							</div>
						</div>
						
							<div class="col-12">
							<div class="card">
								<div class="card-header">
								
									<h6 class="card-subtitle text-muted">
										DataTables.</h6>
								</div>
								<div class="card-body" id="queryResult" style="overflow: auto;">
									<!-- <table id="datatables-buttons" class="table table-striped" style="width:100%">
										<thead>
											<tr>
												<th>Sub Module</th>
												<th>Sub Module Name </th>
												<th>Module</th>
												<th>seqNo</th>
												<th>Is Active</th>
												<th>Edit</th>
												<th> Delete</th>
												
											</tr>
										</thead>
										<tbody>
											<tr th:each="listsubModule : ${listSubModule}">
												<td th:text="${listsubModule.subModuleCode}"></td>
												<td th:text="${listsubModule.subModuleName}"></td>
												<td th:text="${listsubModule.moduleCode}"></td>
												<td th:text="${listsubModule.seqNoSubModule}"></td>
												<td th:text="${listsubModule.acitveSubModule}"></td>
												<td>  
												<a th:href="@{/subModule/{subModuleId}/edit(subModuleId=${listsubModule.subModuleCode})}"
                                                    class="btn btn-primary">
                                                   <i class="fas fa-user-edit ml-2"></i>
                                                </a> 
                                                
                                                 </td>
                                               <td>  
                                                <a th:href="@{/delete/{id}(id=${listsubModule.subModuleCode})}"
                                              class="btn btn-primary">
                                              <i class="fas fa-user-times ml-2"></i>
                                             </a>
                                                </td>  
                                   
											
											</tr>

										
										</tbody>
										<tfoot>
											<tr>
												<th>Sub Module</th>
												<th>Sub Module Name </th>
												<th>Module</th>
												<th>seqNo</th>
												<th>Is Active</th>
												<th>Edit</th>
												<th> Delete</th>
											
											</tr>
										</tfoot>
									</table> -->
								</div>
							</div>
						</div>
	
					</div>


				</div>
			</main>
				<footer class="footer">
		<div th:replace="/fragments/footer :: div"></div>
		</footer>
		</div>

	</div>
	<!-- **************************** Update Modal************************************************************************* -->

	<div class="modal fade" id="updateSubModuleDetailsModal" tabindex="-1"
		role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
		<div class="modal-dialog modal-lg" role="document">
			<div class="modal-content">
				<div class="modal-header text-center" style="background: #f2fffa;">
					<button type="button" class="close" data-dismiss="modal"
						aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
					<h4 class="modal-title w-100 font-weight-bold">Sub
						Module</h4>
				</div>
				<div class="modal-body mx-3">
					<form class="form-horizontal" id="updateRoleForm">
						<input type="hidden" id="updateRoleId" name="updateRole">
						<div class="row" style="margin-right: 25px; margin-top: 20px;">
							<div class="col-md-6">
								<div class="form-group required">
									<label for="updateSubModuleCode"
										class="col-sm-4 control-label required">Sub Module Code :</label>
									<div class="col-sm-8 ">
										<input id="updateSubModuleCode" name="updateSubModuleCode"
											disabled="disabled" class="form-control input-md" type="text">
									</div>
									<span id="errmsg" style="color: red"></span>
								</div>
							</div>
							<div class="col-md-6">
								<div class="form-group required">
									<label for="updateModuleName"
										class="col-sm-4 control-label required">Sub Module Name :</label>
									<div class="col-sm-8 ">
										<input id="updateSubModuleName" name="updateSubModuleName"
											class="form-control input-md" type="text" required>
									</div>
									<span id="errmsg" style="color: red"></span>
								</div>
							</div>
						
							
							
						</div>

						<div class="row" style="margin-right: 25px; margin-top: 40px;">
						
							<div class="col-md-6">
								<div class="form-group required">
									<label for="updateSeq"
										class="col-sm-4 control-label required">Sequence No :</label>
									<div class="col-sm-8 ">
										<input id="updateSeq" name="updateSeq"
											class="form-control input-md" type="text"data-mask="00">
											
									</div>
								</div>
							</div>
								<div class="col-md-6">
								<div class="form-group required">
									<label class="col-sm-4 control-label">Module Code :</label>
									<div class="col-sm-8 ">
										<select id="updateModuleCode" name=updateModuleCode
											class="form-control input-md ">
											<option value="1001">Master</option>
											<option value="1002">Auth</option>
										</select>
									</div>
								</div>
							</div>
								<div class="col-md-6">
								<div class="form-group required">
									<label class="col-sm-4 control-label">Status:</label>
									<div class="col-sm-8 ">
										<select id="updatestatus" name="updatestatus"
											class="form-control input-md ">
											<option value="Y">Active</option>
											<option value="N">Inactive</option>
										</select>
									</div>
								</div>
							</div>
						</div>

						<div class="row form-group">
							<div class="col-md-12"
								style="text-align: right; margin-top: 30px;">
								<div class="form-group">
									<div class="col-sm-7">
										<input id="subMduleUpdateBtn" title="Update" value="Update"
											type="button" class="btn btn-outline-primary"
											style="margin-right: 20px; width: 80px;">
										<button type="button" class="btn btn-outline-warning "
											data-dismiss="modal" style="width: 80px;">Close</button>
									</div>
									<!-- <div class="col-sm-5">
											<p class="alert-color">* All fields are mandatory .</p>
										</div> -->
								</div>
							</div>
						</div>
					</form>
				</div>
			</div>
			<div class="loading" id="loadingUpdate"></div>
			<div class="transparentCover" id="transUpdate"></div>
		</div>
	</div>
	<!-- **************************** Delete  Modal************************************************************************* -->
			<div class="modal fade" id="defaultModalDanger" tabindex="-1" role="dialog" aria-hidden="true">
			<div class="modal-dialog" role="document">
			<div class="modal-content">
			<div class="modal-header">
			<h5 class="modal-title">Delete Sub Module</h5>
			<button type="button" class="close" data-dismiss="modal" aria-label="Close">
			<span aria-hidden="true">&times;</span>
			</button>
			</div>
				
			<div class="modal-body m-3">
			<h1>Delete Account</h1>
			<input id="subModule" name="subModule" type="hidden">
					
    		 <p>Are you sure you want to delete your account?</p>
    
			</div>
			<div class="modal-footer">
			<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
			<button type="button" class="btn btn-danger"id="SubmoduleDeteteBtn">Save changes</button>
			</div>
			</div>
			</div>
			</div>
	

	<svg width="0" height="0" style="position:absolute">
		<defs>
			<symbol viewBox="0 0 512 512" id="ion-ios-pulse-strong">
				<path
					d="M448 273.001c-21.27 0-39.296 13.999-45.596 32.999h-38.857l-28.361-85.417a15.999 15.999 0 0 0-15.183-10.956c-.112 0-.224 0-.335.004a15.997 15.997 0 0 0-15.049 11.588l-44.484 155.262-52.353-314.108C206.535 54.893 200.333 48 192 48s-13.693 5.776-15.525 13.135L115.496 306H16v31.999h112c7.348 0 13.75-5.003 15.525-12.134l45.368-182.177 51.324 307.94c1.229 7.377 7.397 11.92 14.864 12.344.308.018.614.028.919.028 7.097 0 13.406-3.701 15.381-10.594l49.744-173.617 15.689 47.252A16.001 16.001 0 0 0 352 337.999h51.108C409.973 355.999 427.477 369 448 369c26.511 0 48-22.492 48-49 0-26.509-21.489-46.999-48-46.999z">
				</path>
			</symbol>
		</defs>
	</svg>
	<script src="js/app.js"></script>

	
		<script>
		$(function() {
			var resultDataTable;
			
			
			// Datatables basic
			$('#datatables-basic').DataTable({
				responsive : true
			});
			// Datatables with Buttons
			
			$('#loadingUpdate').css('display', 'none');
			$("#transUpdate").css('display', 'none');
			$('.loading').css('display','none');
			$(".transparentCover").css('display', 'none');
			
			getModuleList();

			$("body").on("click", "#datatables-buttons tbody tr .myclass",
					function(e) {
				
						var par = $(this).parent().parent().parent();
						var subModuleCode = par.find("td").eq(1).html();
						var subModuleName = par.find("td").eq(2).html();
						var moduleCode=par.find("td").eq(3).html();
						var seqNo = par.find("td").eq(4).html();
						 var status = par.find("td").eq(5).html(); 
						$("#updateSubModuleCode").val(subModuleCode);
						$("#updateSubModuleName").val(subModuleName);
						$("#updateModuleCode").val(moduleCode);
						$("#updateSeq").val(seqNo);
						 $("#updatestatus").val(status); 
						

					});

		

		$("#subMduleUpdateBtn")
				.click(
						function() {
							//debugger;
							var SubModuleCodeValue = $("#updateSubModuleCode").val();
							var SubModuleNameValue = $.trim($("#updateSubModuleName").val());
							var ModuleCodeValue = $.trim($("#updateModuleCode").val());
							var SubModuleSeqNoValue = $("#updateSeq").val();
							var SubModuleStatusValue = $("#updatestatus").val();
							

							if (SubModuleNameValue === "") {
								swal("Oops!", "Please Enter Sub Module Name!",
										"info");
								return;
							}

							
							var SubModuleInfoObj = new Object();
							SubModuleInfoObj["updateSubModuleCode"]=SubModuleCodeValue;
							SubModuleInfoObj["updateSubModuleName"]=SubModuleNameValue;
							SubModuleInfoObj["updateModuleCode"]=ModuleCodeValue;
							SubModuleInfoObj["updateSeq"]= SubModuleSeqNoValue;
							SubModuleInfoObj["updatestatus"] = SubModuleStatusValue;
				
							
							
							
							$('#loadingUpdate').css('display', 'block');
							$("#transUpdate").css('display', 'block');

							$.ajax({

										type : "POST",
										url : "/updatesub_module",
										data : JSON.stringify(SubModuleInfoObj),
										processData :false,
										contentType :"application/json",
										dataType :'text',
										cache : false,

										success:function(result) {	
											debugger;
										$('#loadingUpdate').css('display',
										'none');
										$("#transUpdate").css('display',
												'none');

										$('#updateSubModuleDetailsModal')
												.modal('toggle');
										getModuleList();
										swal(
												"Success!",
												" Sub Module Information Successfully Saved !",
												"success");
									},
									error : function(result) {
										$('#loadingUpdate').css('display',
												'none');
										$("#transUpdate").css('display',
												'none');
										console.log(result.responseText);
										if (result.status == 0) {

										}
										swal(
												"Error!",
												"Add Sub Module Information Failed. Error occurred at server-side !",
												"error");
									}
								});

					});
		
		     $('#datatables-buttons').on('click','.removeButton', function(e){
			   // Prevent event propagation
			   e.stopPropagation();

			   var $row = $(this).closest('tr');
			   var subModuleCC = resultDataTable.row($row).data();
			     var subModule=subModuleCC[1];
			    $('#subModule').val(subModuleCC[1]);
				console.info(subModule)
				$('#defaultModalDanger').modal('show');
			   //alert('Edit ' + data[1]);
			});
		
		// delete modele code 
	 		$("#SubmoduleDeteteBtn")
				.click(
						
						function() {
							debugger;
				
							
							var SubModuleCodeValue = $("#subModule").val();
							
							var SubModuleInfoObj = new Object();
							SubModuleInfoObj["deleteSubModuleCode"]=SubModuleCodeValue;
							

							$('#loadingUpdate').css('display', 'block');
							$("#transUpdate").css('display', 'block');

							$.ajax({

										type : "POST",
										url : "/deteteSub_module",
										data : JSON.stringify(SubModuleInfoObj),
										processData :false,
										contentType :"application/json",
										dataType :'text',
										cache : false,

										success:function(result) {
											$('#defaultModalDanger').modal('hide');
											
											getModuleList();
											$('#loadingUpdate').css('display',
											'none');
											$("#transUpdate").css('display',
													'none');

											$('#defaultModalDanger')
													.modal('toggle');
											getModuleList();
											swal(
													"Success!",
													" Sub Module Information Successfully Delete !",
													"success");
											
											
											
										},
										error : function(result) {
											
										}
									});

						});
		 
		//delete module code end 
		
		
		function getModuleList(){
			
			$("#queryResult").empty();
			var obj = new Object();
			
			$('#queryResult').append('<table id="datatables-buttons" class="table table-striped display" style="width:100%"></table>');
			$('#datatables-buttons').prepend('<thead></thead>');
			$('#datatables-buttons').prepend('<tbody></tbody>');
			
			$('#loadingUpdate').css('display', 'block');
			$("#transUpdate").css('display', 'block');
			
			$.ajax({
				type : "GET",
				url : "subModules",
				processData : false,
				contentType : "application/json",
				cache : false,
				success : function(data) {
					var tableData=[];
					if (!(typeof data === 'undefined')) {
							
						if (data.length != 0) {

						 	var row = '<tr><th>S.N.<th>Sub Module Code</th><th> Sub Module Name</th><th>Module Code</th><th>Seq No.</th><th>Status</th><th>Action</th></tr>';
							$('#datatables-buttons > thead').append(row); 
							
							$.each(data,function(i,item) {
								
								var rowData = [];
								
								rowData.push((i+1));
								
								for ( var key in item) {
									rowData.push(item["subModuleCode"]);
									rowData.push(item["subModuleName"]);
									rowData.push(item["moduleCode"]);
									rowData.push(item["seqNoSubModule"]);
									rowData.push(item["acitveSubModule"]);
									
									rowData.push('<a style="color: navy" title="Edit" data-toggle="modal" href="#updateSubModuleDetailsModal"><i class="fa fa-edit myclass" style="color: navy; font-size: 16px">Edit</i></a> ||<a class="removeButton" href="#defaultModalDanger" style="color: red" ><i	class="fa fa-times   "style="color: red; font-size: 16px"></i> Remove </a>');
									
								}
								
								
								tableData.push(rowData);
								
								var rowData = [];
								
								/* $("#module_code").val(item['moduleCode']);
								$("#module_name").val(item['moduleName']);
								$("#module_status").val(item['active']);
								$("#seq_no").val(item['seqNo']); */
								
							});
							
							 resultDataTable = $('#datatables-buttons').DataTable({
								//dom: 'Bfrtip',
								destroy: true,
								data:tableData,
					            deferRender:true,
					            scrollCollapse: true,
					            scroller: false,
								lengthMenu :[[10,20,30,-1 ],['10 rows', '20 rows', '30 rows', 'Show all' ] ],
								buttons :['pageLength']
							}); 
							
						}else {
							//swal("Oops!", "No data found !", "info");
						}

					} else {
						//swal("Oops!", "No data found !", "info");
					}
			
					$('.loading').css('display','none');
					$(".transparentCover").css('display', 'none');
				},
				error : function(result) {
					$('.loading').css('display','none');
					$(".transparentCover").css('display', 'none');
					console.log(result.responseText);
					if(result.status==0){
						
					}
					swal("Error!", "Some error occurred at server-side !", "error");
				}
			});//ajax
		}
		
		});
		
	</script>

</body>



</html>